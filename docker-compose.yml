version: "3.9"
services:

    ocrd-controller:
        image: bertsky/ocrd_controller:latest
        
        environment:
          - UID=1001
          - GID=1001
          - UMASK=0002
        
        ports:
           - "8022:22"
           - "8085:8085"
           
        volumes:
           - type: bind
             source: ./ocrd/controller/.ssh/authorized_keys
             target: /authorized_keys
           - ./kitodo/config_modules/metadata:/data # Shared data directory
           - ./ocrd/controller/models/:/models # Resource directory
           - ./ocrd/controller/config/:/config
        
    ocrd-manager:
        image: markusweigelt/ocrd_manager:latest

        environment:
          - UID=1001
          - GID=1001
          - UMASK=0002

        ports:
           - "9022:22"

        volumes:
           - type: bind
             source: ./ocrd/manager/.ssh/authorized_keys
             target: /authorized_keys 
           - type: bind
             source: ./ocrd/manager/.ssh/id_rsa
             target: /id_rsa
           - type: bind
             source: ./kitodo-activemq-client-1.0-SNAPSHOT.jar
             target: /kitodo-activemq-client-1.0-SNAPSHOT.jar
           - ./kitodo/config_modules/metadata:/data # metadata directory  

        tty: true # docker run -t